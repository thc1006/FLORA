#  Federated Reinforcement Learning framework for O-RAN Adaptation(FLORA)
FLORA: ç‚º O-RAN é©æ‡‰æ€§è€Œç”Ÿçš„è¯é‚¦å­¸ç¿’æ¡†æ¶ (Federated Learning for O-RAN Adaptation)

> FLORA: A Federated Reinforcement Learning framework for O-RAN Adaptation. Intelligently solving network slicing challenges through dynamic clustering, personalization, and privacy-preservation.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/release/python-390/)

**FLORA** æ˜¯ä¸€å€‹å°ˆç‚ºç‚º O-RAN é©æ‡‰æ€§ã€å­¸è¡“ç ”ç©¶èˆ‡å¯¦å‹™æ‡‰ç”¨è¨­è¨ˆçš„é–‹æºè¯é‚¦å­¸ç¿’ python æ¡†æ¶ï¼Œæ—¨åœ¨æ¢ç´¢å¦‚ä½•åˆ©ç”¨**è¯é‚¦å¼·åŒ–å­¸ç¿’ (Federated Reinforcement Learning, FRL)** çš„å¼·å¤§èƒ½åŠ›ï¼Œä¾†è§£æ±ºæ¬¡ä¸–ä»£ **O-RAN (é–‹æ”¾ç„¡ç·šæ¥å–ç¶²)** ç’°å¢ƒä¸­ï¼Œæ¥µå…·æŒ‘æˆ°æ€§çš„**ç¶²è·¯åˆ‡ç‰‡ (Network Slicing)** è³‡æºç®¡ç†å•é¡Œã€‚

é€™å€‹å°ˆæ¡ˆä¸åªæ˜¯ä¸€å€‹å–®ä¸€çš„æ¨¡å‹ï¼Œè€Œæ˜¯ä¸€å€‹åŠŸèƒ½å…¨é¢ã€å¯é«˜åº¦å®¢è£½åŒ–çš„**å¯¦é©—å¹³å°**ï¼Œè®“ç ”ç©¶è€…å¯ä»¥è¼•é¬†æ¯”è¼ƒä¸åŒè¯é‚¦å­¸ç¿’ç­–ç•¥çš„å„ªåŠ£ï¼Œä¸¦æ·±å…¥æ¢è¨**é©æ‡‰æ€§ (Adaptation)**ã€**å€‹äººåŒ– (Personalization)** èˆ‡**éš±ç§ä¿è­· (Privacy)** ç­‰å‰æ²¿è­°é¡Œã€‚

## å°ˆæ¡ˆç°¡ä»‹

åœ¨ 5G/6G çš„æ™‚ä»£ï¼Œç¶²è·¯ä¸å†åªæä¾›å–®ä¸€æœå‹™ã€‚æˆ‘å€‘éœ€è¦åŒæ™‚æ»¿è¶³éœ€è¦è¶…å¤§é »å¯¬çš„å½±éŸ³ä¸²æµ (eMBB) å’Œè¦æ±‚è¶…ä½å»¶é²çš„è‡ªé§•è»Šæˆ–å·¥æ¥­ç‰©è¯ç¶² (URLLC) ç­‰å„å¼å„æ¨£çš„éœ€æ±‚ã€‚ç¶²è·¯åˆ‡ç‰‡æŠ€è¡“å› æ­¤è€Œç”Ÿï¼Œä½†è¦å¦‚ä½•ã€Œæ™ºæ…§åŒ–ã€åœ°å‹•æ…‹åˆ†é…è³‡æºçµ¦ä¸åŒçš„åˆ‡ç‰‡ï¼Œä¸€ç›´ä»¥ä¾†éƒ½æ˜¯å€‹å¤§å“‰å•ã€‚

å‚³çµ±çš„é›†ä¸­å¼ AI è¨“ç·´éœ€è¦å°‡æ‰€æœ‰åŸºåœ°å°çš„åŸå§‹æ•¸æ“šéƒ½å‚³å›ä¸­å¤®ä¼ºæœå™¨ï¼Œé€™ä¸åƒ…å¸¶ä¾†äº†å·¨å¤§çš„æ•¸æ“šå‚³è¼¸æˆæœ¬ï¼Œæ›´æœ‰ä¾µçŠ¯ç”¨æˆ¶éš±ç§çš„é¢¨éšªã€‚

**FLORA** çš„èª•ç”Ÿï¼Œå°±æ˜¯ç‚ºäº†è§£æ±ºé€™å€‹å•é¡Œã€‚

æˆ‘å€‘æ¡ç”¨è¯é‚¦å­¸ç¿’çš„å»ä¸­å¿ƒåŒ–ç¯„å¼ï¼Œè®“æ¯å€‹åŸºåœ°å°ï¼ˆåœ¨æˆ‘å€‘çš„æ¡†æ¶ä¸­ç¨±ç‚ºã€Œå®¢æˆ¶ç«¯ã€ï¼‰åœ¨æœ¬åœ°ç«¯ç”¨è‡ªå·±çš„æ•¸æ“šè¨“ç·´æ¨¡å‹ï¼Œåªå°‡åŠ å¯†ã€åŒ¿åçš„æ¨¡å‹æ›´æ–°è³‡è¨Šåˆ†äº«å‡ºä¾†ã€‚FLORA çš„æ ¸å¿ƒç›®æ¨™ï¼Œæ˜¯è¨“ç·´å‡ºä¸€å€‹èƒ½å¤ è°æ˜åˆ¤æ–·ã€Œåœ¨ç•¶ä¸‹é€™å€‹æ™‚é–“é»ï¼Œæˆ‘æ‡‰è©²æ›´é‡è¦– eMBB çš„å-åé‡ï¼Œé‚„æ˜¯æ›´å„ªå…ˆä¿è­‰ URLLC çš„ä½å»¶é²ï¼Ÿã€çš„æ™ºæ…§ä»£ç† (Agent)ã€‚

## æ ¸å¿ƒåŠŸèƒ½èˆ‡ç‰¹è‰² âœ¨

FLORA æ¡†æ¶ç¶“éç²¾å¿ƒè¨­è¨ˆï¼Œå…§å»ºäº†è¨±å¤šç‚ºäº†æ–¹ä¾¿ç ”ç©¶æ¯”è¼ƒçš„å¼·å¤§åŠŸèƒ½ï¼š

* **ğŸ“ˆ å¤šæ¨¡å¼å¯¦é©—å¹³å°:** å…§å»ºå¤šç¨®ä¸»æµè¨“ç·´æ¶æ§‹ï¼Œä¸€éµåˆ‡æ›ï¼Œè¼•é¬†é€²è¡Œæ•ˆèƒ½æ¯”è¼ƒï¼š
    * `Centralized`: å‚³çµ±çš„é›†ä¸­å¼è¨“ç·´ã€‚
    * `Isolated`: å„å®¢æˆ¶ç«¯å®Œå…¨ç¨ç«‹è¨“ç·´ï¼Œäº’ä¸å¹²æ“¾ã€‚
    * `FedAvg`: æœ€ç¶“å…¸çš„è¯é‚¦å¹³å‡æ¼”ç®—æ³•ã€‚
    * `FedProx`: å°ˆç‚ºè™•ç†å®¢æˆ¶ç«¯ä¹‹é–“æ•¸æ“šå·®ç•°ï¼ˆNon-IIDï¼‰è€Œè¨­è¨ˆçš„æ¼”ç®—æ³•ã€‚

* **ğŸ¤– æ™ºæ…§å‹•æ…‹åˆ†ç¾¤ (Dynamic Clustering):** é€™æ˜¯ FLORA æœ€å…·å‰µæ–°çš„åŠŸèƒ½ä¹‹ä¸€ï¼åœ¨ `ClusteredFL` æ¨¡å¼ä¸‹ï¼Œä¼ºæœå™¨æœƒå®šæœŸåˆ†ææ‰€æœ‰å®¢æˆ¶ç«¯çš„æ¨¡å‹ç›¸ä¼¼åº¦ï¼Œä½¿ç”¨ K-Means æ¼”ç®—æ³•è‡ªå‹•å°‡ã€Œè¡Œç‚ºæ¨¡å¼ã€ç›¸è¿‘çš„å®¢æˆ¶ç«¯åˆ†åœ¨åŒä¸€ç¾¤ã€‚èšåˆåªåœ¨ç¾¤å…§é€²è¡Œï¼Œè®“æ¨¡å‹èƒ½æ›´å¥½åœ°é©æ‡‰ä¸åŒå€åŸŸçš„ç¶²è·¯ç‰¹æ€§ã€‚

* **ğŸ‘¤ å€‹äººåŒ–è¯é‚¦å­¸ç¿’ (PFL):** æˆ‘å€‘ç›¸ä¿¡ã€Œå› ææ–½æ•™ã€ï¼åœ¨è¯é‚¦è¨“ç·´çµæŸå¾Œï¼ŒFLORA æ”¯æ´è®“æ¯å€‹å®¢æˆ¶ç«¯æ‹¿è‘—è¨“ç·´å¥½çš„å…±ç”¨æ¨¡å‹ï¼Œåœ¨è‡ªå·±çš„æœ¬åœ°æ•¸æ“šä¸Šé€²è¡Œæœ€å¾Œçš„ã€Œå¾®èª¿ (Fine-tuning)ã€ï¼Œæ‰“é€ å‡ºæœ€é©åˆè‡ªå·±çš„å°ˆå±¬æ¨¡å‹ã€‚

* **ğŸ›¡ï¸ è² é·ç§»é˜²è­· (Negative Transfer Protection):** å¾®èª¿ä¸è¦‹å¾—ç¸½æ˜¯å¥½äº‹ã€‚FLORA å…§å»ºäº†æ™ºæ…§å›é€€æ©Ÿåˆ¶ï¼Œå¦‚æœå€‹äººåŒ–å¾®èª¿å¾Œçš„æ¨¡å‹æ•ˆèƒ½åè€Œè®Šå·®äº†ï¼ˆå­¸æ­ªäº†ï¼‰ï¼Œç³»çµ±æœƒè‡ªå‹•å°‡å…¶æ¨æ£„ï¼Œä¿ç•™åŸæœ¬æ•ˆèƒ½è¼ƒä½³çš„æ¨¡å‹ã€‚

* **ğŸ”’ å·®åˆ†éš±ç§ (Differential Privacy):** éš±ç§æ˜¯æˆ‘å€‘çš„é‡ä¸­ä¹‹é‡ã€‚æœ¬æ¡†æ¶æ•´åˆäº† Google çš„ Opacus å‡½å¼åº«ï¼Œå¯ä»¥åœ¨è¯é‚¦å­¸ç¿’éç¨‹ä¸­ç‚ºæ¨¡å‹æ›´æ–°æ·»åŠ æ•¸å­¸ä¸Šå¯è­‰æ˜çš„éš±ç§ä¿éšœï¼Œä¸¦èƒ½æœ‰æ•ˆç›£æ§èˆ‡ç®¡ç†éš±ç§é ç®— (Epsilon) çš„æ¶ˆè€—ã€‚

* **ğŸŒ ç¾å¯¦ä¸–ç•Œæ¨¡æ“¬:** ç‚ºäº†è®“ç ”ç©¶æ›´è²¼è¿‘çœŸå¯¦å ´æ™¯ï¼Œæˆ‘å€‘é‚„æ¨¡æ“¬äº†ï¼š
    * **æ¨¡å‹å£“ç¸® (Compression):** æ¨¡æ“¬è¡Œå‹•è£ç½®ä¸Šå‚³æ¨¡å‹æ™‚çš„æœ‰é™é »å¯¬ã€‚
    * **å®¢æˆ¶ç«¯æ‰ç·š (Dropout):** æ¨¡æ“¬ä¸ç©©å®šçš„ç¶²è·¯ç’°å¢ƒä¸‹ï¼Œéƒ¨åˆ†å®¢æˆ¶ç«¯ç„¡æ³•åƒèˆ‡è©²è¼ªè¨“ç·´çš„æƒ…å¢ƒã€‚

## è³‡æ–™ä¾†æº

æœ¬å°ˆæ¡ˆçš„æ‰€æœ‰å¯¦é©—ï¼Œçš†åŸºæ–¼ä¸€å€‹å…¬é–‹çš„ã€çœŸå¯¦ä¸–ç•Œçš„ O-RAN æ¨¡æ“¬æ•¸æ“šé›†ï¼š

* **[CoLORAN: A Radio Access Network Slicing and Orchestration Open Dataset](https://github.com/wineslab/colosseum-oran-coloran-dataset)**

æˆ‘å€‘ç”±è¡·æ„Ÿè¬ WINES Lab æä¾›å¦‚æ­¤é«˜å“è³ªçš„æ•¸æ“šï¼Œè®“å­¸è¡“ç ”ç©¶ç¤¾ç¾¤èƒ½åœ¨æ­¤åŸºç¤ä¸Šé€²è¡Œæ¢ç´¢èˆ‡å‰µæ–°ã€‚åœ¨æ‚¨ä½¿ç”¨æœ¬æ¡†æ¶æ™‚ï¼Œä¹Ÿè«‹è¨˜å¾—å¼•ç”¨ä»–å€‘çš„åŸå§‹è«–æ–‡ã€‚

## æ¶æ§‹æ¦‚è¦½

æ•´å€‹ç¨‹å¼ç¢¼ä¸»è¦ç”±ä»¥ä¸‹å¹¾å€‹æ ¸å¿ƒæ¨¡çµ„æ§‹æˆï¼š

1.  `DataManager`: è² è²¬è®€å–ä¸¦é è™•ç† `kpi_traces_final_robust0.parquet` æª”æ¡ˆï¼Œä¸¦ç‚ºæ¯å€‹å®¢æˆ¶ç«¯æº–å‚™å¥½å°ˆå±¬çš„æ•¸æ“šè»Œè·¡ã€‚
2.  `PairedEnv`: ç‚ºå¼·åŒ–å­¸ç¿’ä»£ç†é‡èº«æ‰“é€ çš„äº’å‹•ã€Œç’°å¢ƒã€ã€‚
3.  `RLAgent`: å¯¦ç¾äº† DQN æ¼”ç®—æ³•çš„æ ¸å¿ƒå­¸ç¿’ä»£ç†ï¼Œä¸¦æ•´åˆäº†éš±ç§ä¿è­·ã€FedProx ç­‰é‚è¼¯ã€‚
4.  `FLServer`: æ¨¡æ“¬è¯é‚¦å­¸ç¿’ä¸­çš„ä¸­å¤®ä¼ºæœå™¨ï¼Œè² è²¬æ¨¡å‹çš„åˆ†ç™¼ã€èšåˆèˆ‡å®¢æˆ¶ç«¯åˆ†ç¾¤ã€‚
5.  `ExperimentRunner`: å¯¦é©—çš„ç¸½æŒ‡æ®ï¼Œè² è²¬ä¸²é€£æ‰€æœ‰æ¨¡çµ„ï¼ŒåŸ·è¡Œå®Œæ•´çš„è¨“ç·´èˆ‡è©•ä¼°æµç¨‹ã€‚

## å¦‚ä½•åŸ·è¡Œå¯¦é©—

æ‰€æœ‰å¯¦é©—ç ”ç©¶çš„ `.ipynb` éƒ½ä½æ–¼æ­¤ repo çš„æ ¹ç›®éŒ„ï¼Œæ‚¨å¯ä»¥å°‡å…¶ä¸‹è¼‰ä¸‹ä¾†é‡æ–°ä¸Šå‚³è‡³æ‚¨çš„ Google Driveï¼Œä½¿ç”¨ **Google Colab** å…è²»çš„ GPU ä¾†é€²è¡Œè¨“ç·´ã€‚

1.  **è¨­å®šè·¯å¾‘:** é¦–å…ˆå…ˆä¸‹è¼‰ [`kpi_traces_final_robust0.parquet`](https://drive.google.com/file/d/1frt_iUARKTmIgEvHovEIzSPPtK0ZmWVl/view?usp=drive_link) ï¼Œç„¶å¾Œå°‡æ­¤æª”æ¡ˆä¸Šå‚³è‡³æ‚¨é›²ç«¯ç¡¬ç¢Ÿç•¶ä¸­ï¼Œæ‚¨è‡ªé¸è·¯å¾‘çš„è³‡æ–™å¤¾ã€‚
2.  **è¨­å®šè·¯å¾‘:** è«‹å…ˆç¢ºèª `DATA_PATH` æŒ‡å‘æ‚¨å­˜æ”¾ `kpi_traces_final_robust0.parquet` æª”æ¡ˆçš„æ­£ç¢ºä½ç½®ã€‚
3.  **é¸æ“‡æ¨¡å¼èˆ‡ç¨®å­:** æ‚¨å¯ä»¥ä¿®æ”¹ `MODES_TO_RUN` åˆ—è¡¨ä¾†æ±ºå®šè¦åŸ·è¡Œå“ªäº›å¯¦é©—æ¨¡å¼ï¼Œä¸¦é€é `SEEDS` åˆ—è¡¨ç­‰åƒæ•¸ï¼Œä¾†é€²è¡Œå¤šæ¬¡ç¨ç«‹å¯¦é©—ä»¥ç¢ºä¿æœ€çµ‚è¼¸å‡ºçµæœçš„é­¯æ£’æ€§ã€‚
4.  **åŸ·è¡Œ:** åŸ·è¡Œè©² Cellï¼Œå¯¦é©—ä¾¿æœƒè‡ªå‹•é–‹å§‹ã€‚æ‰€æœ‰çµæœï¼ˆåŒ…å«è¨“ç·´æ­·å²ã€è©•ä¼°æ•¸æ“šã€éš±ç§æˆæœ¬å’Œè¨­å®šæª”ï¼‰éƒ½æœƒè¢«å„²å­˜åœ¨ `BASE_OUTPUT_DIR` æ‰€å®šç¾©çš„ï¼ˆå®šç¾©åœ¨ Cell 9ï¼‰è³‡æ–™å¤¾ä¸­ã€‚

> å¦‚æœæƒ³è¦çŸ¥é“ `kpi_traces_final_robust0.parquet` æ˜¯æ€éº¼ä¾†çš„è«‹è©³é–±æ­¤è™• [è³‡æ–™å‰è™•ç†(Data Preprocessing)](https://github.com/thc1006/FLORA/tree/main/%E8%B3%87%E6%96%99%E5%89%8D%E8%99%95%E7%90%86(Data%20Preprocessing))ã€‚

## æˆæ¬Š (License)

æœ¬å°ˆæ¡ˆæ¡ç”¨ [MIT License](LICENSE) é€²è¡Œæˆæ¬Šã€‚
